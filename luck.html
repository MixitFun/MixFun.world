<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MixFun</title>
    <link rel="icon" href="img/logo.png" type="image/x-icon">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Please help me to win the iPhone!📱Just click the link below😁" />
    <meta property="og:description" content="Please help me to win the iPhone!📱Just click the link below😁" />
    <meta property="og:image" content="images/share-logo.png" />
    <link rel="icon" href="img/logo.png" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css"/>
    <link rel="stylesheet" type="text/css" href="css/bootstrap-grid.css"/>
    <link rel="stylesheet" type="text/css" href="css/bootstrap-reboot.css"/>
</head>

<script src="https://code.jquery.com/jquery-3.4.0.js"></script>
<script src="js/bootstrap.js"></script>
<script src="js/bootstrap.bundle.js"></script>
<script src="js/clipboard.min.js"></script>
<!--<script src="js/wasap.js"></script>-->
<style>
    .top{
        background-image: url("img/bg_new.png");
        background-repeat: no-repeat;
        background-size: 100%;
    }
    .tooltip-inner{
        background-color: #b3d7ff;
        color: #6974FF;
        max-width: 300px;
    }
    .bs-tooltip-top .arrow::before, .bs-tooltip-auto[x-placement^="top"] .arrow::before{
        border-top-color: #b3d7ff;
    }
    .tooltip{
        align-content: center;
        z-index: -1;
    }
    input{
        margin-top: 15px;
    }
    textarea{
        margin-top: 15px;
    }
    li:hover{
        background-color: #adb5bd;
    }
    .nav-link.active{
        color: #007bff;
    }
    .shade{
        margin-top: 30px;
    }
</style>
<body>
<div class="container" style="padding:0;background-color: #f7f7fb;" align="center">
    <div align="center">
        <img id="tx" style="width: 50px;height: 50px;border-radius: 25px;position: inherit;z-index: 9999;margin-top: 25px;">
        <p id="mc"></p>
    </div>
    <div class="card" style="width: 95%;border-radius: 10px;box-shadow: 2px 2px 2px #EEEEEE;">
        <div class="card-body" style="padding: 10px;">
            <p id="totalCoins" style="color: #767EF0; font-family: PingFangSC-Regular, sans-serif; font-size: 30px; font-weight: bold; margin-bottom: 0px"></p>
            <p style="color: #9B9B9B; font-family: PingFangSC-Regular, sans-serif; font-size: 12px; margin-bottom: 15px">Mixcoin Reward</p>
            <table width="100%" style="margin-bottom: 0px">
                <tr>
                    <td width="33%" align="center">
                        <p id="watchCoins" style="color: #353535; font-size: medium; margin-bottom: 0px">
                            <p style="color: #9B9B9B; font-family: PingFangSC-Regular, sans-serif; font-size: 12px; margin-bottom: -10px">Watch Reward</p>
                        </p>
                    </td>
                    <td width="33%" align="center">
                        <p id="uploadCoins" style="color: #353535; font-size: medium; margin-bottom: 0px">
                            <p style="color: #9B9B9B; font-family: PingFangSC-Regular, sans-serif; font-size: 12px; margin-bottom: -10px">Upload Reward</p>
                        </p>
                    </td>
                    <td width="33%" align="center">
                        <p id="inviteCoins" style="color: #353535; font-size: medium; margin-bottom: 0px">
                            <p style="color: #9B9B9B; font-family: PingFangSC-Regular, sans-serif; font-size: 12px; margin-bottom: -10px">Referral Reward</p>
                        </p>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="card" style="width: 95%;border-radius: 10px;box-shadow: 2px 2px 2px #EEEEEE;margin-top: 20px">
        <div class="card-body" style="padding: 10px;">
            <p style="color: #9B9B9B;font-size: medium">You've invited <span id="num" style="color: #6974FF"></span> friends</p>
            <div id="ref"></div>
            <p>We are very sorry to announce that we stopped the referral program at the moment because we found hackers attacked our system to earn coins. We are working hard to resolve the issue. Please be patient to wait for further notice. - MixFun Team</p>
        </div>
    </div>

    <div class="card" style="width: 95%;border-radius: 10px;box-shadow: 2px 2px 2px #EEEEEE; margin-top: 20px">
        <img src="img/Fun_Creators_Banner.png" style="width: 100%; border-top-left-radius: inherit; border-top-right-radius: inherit;">
        <p style="color: #353535; font-family: PingFangSC-Regular, sans-serif; font-size: 18px; font-weight: bold; margin-top: 10px; margin-bottom: 5px">Top Tipped Videos</p>
        <div class="tab-pane fade in active show topListDiv" id="topListDiv"></div>
        <div style="width: 100%; display: inline-block;">
            <button class="btn" style="margin-top: 10px; margin-bottom: 10px; width: 40%; color: black; border: 0; outline: none;" onclick="perTopList()">< Previous </button>
            <button class="btn" style="margin-top: 10px; margin-bottom: 10px; width: 40%; color: black; border: 0; outline: none;" onclick="nextTopList()">Next ></button>
        </div>
    </div>

    <div style="margin-top: 20px;border-width: thin;border-color: #9B9B9B;">
        <ul class="nav nav-tabs">
            <li class="nav-item" style="width: 50%">
                <a class="nav-link active" href="#draw" data-toggle="tab" id="tabIn">Mobile Legends</a>
            </li>
            <li class="nav-item" style="width: 50%">
                <a class="nav-link" href="#buy" data-toggle="tab">Mobile Loads</a>
            </li>
        </ul>
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade in active show commodity" id="draw">
            </div>
            <div class="tab-pane fade" id="buy">
            </div>
        </div>
    </div>

    <div class="card" align="center" style="width: 95%;border-radius: 10px;box-shadow: 2px 2px 2px #EEEEEE;margin-top: 20px;">
        <a href="https://sporti.page.link/yodo">
            <img src="img/yodo_banner.png" style="width: 100%; border-radius: 10px;">
        </a>
    </div>

</div>

<div id="footer" style="width: 100%;margin-top: 30px;" align="center">
    <p>Contact us on <a href="https://www.facebook.com/groups/419649578852831/"> Facebook</a></p>
    <p style="color: #BC9982;">© 2019 MIXFUN LIMITED</p>
</div>

<!-- alert -->
<div class="modal fade" id="ModalAlert" tabindex="-1" role="dialog" aria-labelledby="Box" aria-hidden="true" style="margin-top: 40%;border-radius: 20px;">
    <div class="modal-dialog" role="document" style="border-radius: 20px;">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header" style="background: linear-gradient(to right, #b4d0ef, #e4f1f8);border-radius: 20px 20px 0 0;">
                <h5 class="modal-title">Message</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="alert">
            </div>
        </div>
    </div>
</div>

<!-- alert -->
<div class="modal fade" id="ModalConf" tabindex="-1" role="dialog" aria-labelledby="Box" aria-hidden="true" style="margin-top: 40%;border-radius: 20px;">
    <div class="modal-dialog" role="document" style="border-radius: 20px;">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header" style="background: linear-gradient(to right, #b4d0ef, #e4f1f8);border-radius: 20px 20px 0 0;">
                <h5 class="modal-title">Warning</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="type1"><span class="hf"></span> coins will be deducted. No Refund. Confirm to draw?</p>
                <p id="type2"><span class="hf"></span> coins will be deducted. Confirm to redeem?</p>
                <button class="btn btn-info" onclick="cjl()">Continue</button>
                <button class="btn" data-dismiss="modal" aria-label="Close">Cancel</button>
                <input id="it" type="hidden"/>
                <input id="itname" type="hidden"/>
                <input id="ittype" type="hidden"/>
            </div>
        </div>
    </div>
</div>

<!-- Exchange -->
<div class="modal fade" id="ModalExchange" tabindex="-1" role="dialog" aria-labelledby="Box" aria-hidden="true" style="margin-top: 8%;border-radius: 20px;">
    <div class="modal-dialog" role="document" style="border-radius: 20px;height: 100%">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header" style="background: linear-gradient(to right, #b4d0ef, #e4f1f8);border-radius: 20px 20px 0 0;">
                <h5 class="modal-title">Redeem
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding-bottom: 5px;">
                    <span>We will send out the prizes as soon as possible in 3 DAYS. Thanks for your patience.
                    </span>
            </div>
            <span id="bt" style="color: red;margin-left: 10%;"></span>
            <div class="modal-body" align="center">
                <input type="hidden" id="id"/>
                <input type="hidden" id="commodity_id"/>
                <input class="form-control" type="text" id="recipient" placeholder="Enter your name" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"/>
                <input placeholder="Telecom Company(Smart or Globe)" class="form-control" id="phoneType" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;margin-top: 10px;">
                <input class="form-control" type="text" id="phone" placeholder="Enter your phone number" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"/>
                <input class="form-control" type="text" id="moblieLegend" placeholder="Mobile Legends ID:12345678" maxlength="9" style="border-radius: 15px;background-color: #F1F1F1;border: 0px; width: 78%"/>
                <input class="form-control" type="text" id="moblieLegendExtra" placeholder="1234" maxlength="4" style="border-radius: 15px;background-color: #F1F1F1;border: 0px; width: 20%"/>
                <textarea class="form-control" id="address" placeholder="Enter your address" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"></textarea>
                <p style="margin-top: 10px;">Should you have any questions, please inbox us on MixFun Facebook</p>
                <button onclick="buy()" class="btn" style="background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;">Submit</button>
            </div>
        </div>
    </div>
</div>

<!-- tip -->
<div class="modal fade" id="tot" tabindex="-1" role="dialog" aria-labelledby="Box" aria-hidden="true" style="margin-top: 20%;">
    <div class="modal-dialog" role="document" style="border-radius: 20px;height: 100%">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header">
                <h5 class="modal-title" id="copy_label">
                </h5>
            </div>
        </div>
    </div>
</div>

<!-- tip -->
<div class="modal fade" id="zzd" tabindex="-1" role="dialog" aria-labelledby="Box" aria-hidden="true" style="margin-top: 20%;" align="center">
    <div class="modal-dialog" role="document" style="border-radius: 20px;height: 100%">
        <div class="spinner-grow text-primary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-secondary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-success" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-danger" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-warning" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-info" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-light" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-dark" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</div>
</body>

<script type="text/javascript">
    var baseUrl = "https://api.mixit.fun";
    var clientHeight = document.body.clientHeight;
    var clientWidth = document.body.clientWidth;
    $('.top').css('height',170/(375/clientWidth)+"px");
    $('.d-block').css('height',clientHeight/4);
    $('#ModalExchange').css('height',clientHeight);
    $('#zzd').css('margin-top',clientHeight/2);

    $('#tips').tooltip('show');
    $('.toast').toast('show');

    function GetRequest() {
        var url = location.search;
        var theRequest = new Object();
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            strs = str.split("&");
            for (var i = 0; i < strs.length; i++) {
                theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
            }
        }
        return theRequest;
    }

    var token =  GetRequest().id;
    $.ajax({
        method: 'get',
        url: baseUrl+'/user/referralList',
        headers:{
            authorization:token
        },
        contentType:'application/json',
        dataType: 'json',
        success: function(data){
            $('#num').html(data.data.length);
            var ht = '';
            data.data.forEach(function (item,index) {
                var img = "img/person.png";
                if(item.avatar != null && item.avatar != '' && item.avatar != ' '){
                    img = item.avatar;
                }
                if (index > 9) {
                    return false;
                }
                ht+='<img src="'+img+'" style="width: 40px;height: 40px;border-radius: 20px;margin: 2px;"/>';
            });
            $('#ref').html(ht);
        }
    });
    
    $.ajax({
        method: 'get',
        url: "https://api.mixit.fun/"+'user/wallet',
        headers:{
            authorization:token
        },
        contentType:'application/json',
        dataType: 'json',
        success: function(data){
            $('#totalCoins').text(data.data.totalCoin);
            $('#watchCoins').text(data.data.watchCoin);
            $('#uploadCoins').text(data.data.uploadCoin);
            $('#inviteCoins').text(data.data.inviteCoin);
        }
    });

    var isBlockUser = false;
    var fc;
    var lj;
    $.ajax({
        method: 'get',
        url: "https://api.mixit.fun"+'/user/profile',
        headers:{
            authorization:token
        },
        contentType:'application/json',
        dataType: 'json',
        success: function(data){
            if (data.data.status == -1) {
                isBlockUser = true;
            }
            fc = "https://www.facebook.com/sharer/sharer.php?u=https://mixfun.world/openbox?shareCode="+data.data.ownShareCode+" &t=Please help me to win the iPhone!📱Just click the link below😁";
            lj = "https://mixfun.world/openbox?shareCode="+data.data.ownShareCode;
            if(data.data.avatar == ''){
                $('#tx').attr('src','img/person.png');
            }else{
                $('#tx').attr('src',data.data.avatar);
            }
            $('#mc').text(data.data.nickname);
            $('#shareId').val(data.data.ownShareCode);
            if(data.data.shareCode != null){
                $('.shade').css('display','none');
            }
            $('#copy').attr('data-clipboard-text',data.data.ownShareCode);
            $('#lj').val("https://mixfun.world/openbox?shareCode="+data.data.ownShareCode);
            $('.fc').attr('href',"https://www.facebook.com/sharer/sharer.php?u=https://mixfun.world/openbox?shareCode="+data.data.ownShareCode+" &t=Please help me to win the iPhone!📱Just click the link below😁");
            $('#wc').attr('href',"https://api.whatsapp.com/api/send?phone=+8618682018597&send?text=Please help me to win the iPhone!📱Just click the link below😁  https://mixfun.world/openbox?shareCode="+data.data.ownShareCode);
        }
    });

    var topList = new Array()
    var toplistPage = 1;
    $.ajax({
        method: 'post',
        url: "https://api.mixit.fun/dynamic/page/topPickList",
        headers:{
            authorization:token
        },
        data: JSON.stringify({
            pageNum: 1,
            pageSize: 50,
            query: {
                keyword: ""
            }
        }),
        dataType: 'json',
        contentType:'application/json',
        success: function(data){
            topList = data.data.records;
            toplistPage = 1;
            loadTopList(toplistPage);
        }
    });

    var shopSpotDic = new Array();
    $.ajax({
        method: 'post',
        url: baseUrl+'/shop/list',
        headers:{
            authorization:token
        },
        data: {
            type: 1
        },
        dataType: 'json',
        success: function(data) {
            if(data.status == 0) {
                var ht = '<p style="color: #ff000080;margin-top: 5px;width: 95%" class="alert alert-primary">Everyone can redeem once everyday if there is available spot. Restock time will be at 11am & 9pm daily. First come first served. (Philippines region ONLY)</p>';
                data.data.forEach(function(item, index) {
                    shopSpotDic[item.id] = item.glh;
                    ht+= '<div class="media"style="padding: 3%">'+
                        '<div style="width: 25%;">' +
                        '<img src="'+item.img+'" class="align-self-start mr-sm-2" style="width: 100%;border-radius: 5px;"/>' +
                        '<div style="width: 100%;height: 20px;background-color: #1b1e21;color: white;opacity: 0.6;margin-top: -20px;">'+item.sale+' coin</div>'+
                        '</div>'+
                        '<div class="media-body" style="padding: 3%;">'+
                        '<div class="mt-0"><p style="width: 100%;margin: 0px;text-align: left;"><span style="width: 80%;">'+item.name+'</span><span style="color: #9B9B9B;float: right;font-size: small;">Daily Total：'+item.amount+'</span></p></div>'+
                        '<p style="margin-top: 2px;margin-bottom: 5px;text-align: left;">'+item.description+'</p>'+
                        '<div class="mt-0">' +
                        '<p style="width: 100%;text-align: left;"><span>Spot: '+item.glh+'</span>' +
                        '<button class="btn-sm" style="float: right;background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;" onclick="cj('+item.id+',\''+item.name+'\','+item.sale+',2)">&nbsp;Redeem&nbsp;</button></p></div>'+
                        '</div>'+
                        '</div>';
                });
                $('.commodity').html(ht);

            }
        }
    });

    $.ajax({
        method: 'post',
        url: baseUrl+'/shop/list',
        headers:{
            authorization:token
        },
        data: {
            type: 2
        },
        dataType: 'json',
        success: function(data) {
            if(data.status == 0) {
                var ht = '<p style="color: #ff000080;margin-top: 5px;width: 95%" class="alert alert-primary">Everyone can redeem once everyday if there is available spot. Restock time will be at 11am & 9pm daily. First come first served. (Philippines region ONLY)</p>';
                data.data.forEach(function(item, index) {
                    shopSpotDic[item.id] = item.glh;
                    ht+= '<div class="media"style="padding: 3%">'+
                        '<div style="width: 25%;">' +
                        '<img src="'+item.img+'" class="align-self-start mr-sm-2" style="width: 100%;border-radius: 5px;"/>' +
                        '<div style="width: 100%;height: 20px;background-color: #1b1e21;color: white;opacity: 0.6;margin-top: -20px;">'+item.sale+' coin</div>'+
                        '</div>'+
                        '<div class="media-body" style="padding: 3%;">'+
                        '<div class="mt-0"><p style="width: 100%;margin: 0px;text-align: left;"><span style="width: 80%;">'+item.name+'</span><span style="color: #9B9B9B;float: right;font-size: small;">Daily Total：'+item.amount+'</span></p></div>'+
                        '<p style="margin-top: 2px;margin-bottom: 5px;text-align: left;">'+item.description+'</p>'+
                        '<div class="mt-0">' +
                        '<p style="width: 100%;text-align: left;"><span>Spot: '+item.glh+'</span>' +
                        '<button class="btn-sm" style="float: right;background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;" onclick="cj('+item.id+',\''+item.name+'\','+item.sale+',2)">&nbsp;Redeem&nbsp;</button></p></div>'+
                        '</div>'+
                        '</div>';
                });
                $('#buy').html(ht);
            }
        }
    });

    function cj(it,name,sale,type,commodity_id){
        if (isBlockUser) {
            var msg = "We launched an algorithm to detect coin farming and spam activities. Your account has been blocked from prized redeem due to suspected activiteies. If you think it's a mistake, please appeal by sending email to Hello@mixfun.world. We'll review it ASAP.";
            $('#alert').html('<p>'+msg+'</p>');
            $('#ModalAlert').modal('show');
        } else {
            if (shopSpotDic[it] > 0) {
                $('#ModalConf').modal('show');
                $('#it').val(it);
                $('#itname').val(name);
                $('#ittype').val(type);
                $('#commodity_id').val(commodity_id);
                if(type == 1){
                    $('#type2').css('display','none');
                    $('#type1').css('display','block');
                }else{
                    $('#type1').css('display','none');
                    $('#type2').css('display','block');
                }
                $('.hf').text(sale);
            } else {
                let msg = "The stock is out now, the restock time will be at 11am & 9pm daily. Please come back later.";
                $('#alert').html('<p>'+msg+'</p>');
                $('#ModalAlert').modal('show');
            }
        }
    }

    function dde(name, data) {
        if(name == 'Mobile Legends'){
            $('#address').val('');
            $('#phone').val('');
            $('#phoneType').val('');
            $('#address').css('display','none');
            $('#phone').css('display','none');
            $('#phoneType').css('display','none');
            $('#moblieLegend').css('display','inline-block');
            $('#moblieLegendExtra').css('display','inline-block')
        }else{
            $('#moblieLegend').val('');
            $('#moblieLegendExtra').val('');
            $('#address').css('display','block');
            $('#phone').css('display','block');
            $('#phoneType').css('display','block');
            $('#moblieLegend').css('display','none');
            $('#moblieLegendExtra').css('display', 'none');
        }
        $('#ModalExchange').modal('show');
        $('#id').val(data.data.id);
    }

    var ss;
    var gmfh;
    function cjl(){
        var it = $('#it').val();
        var gmname = $('#itname').val();
        var type = $('#ittype').val();
        $('#ModalConf').modal('hide');
        $.ajax({
            method: 'post',
            url: baseUrl+'/shop/exchange',
            headers:{
                authorization:token
            },
            data: {
                commodityId: it,
                type: type
            },
            dataType: 'json',
            success: function(data) {
                if (data.status == 0) {
                    $('#zzd').modal('show');
                } else {
                    var msg = data.msg;
                    if (msg == "The stock for this hour is out. Please come back next hour.") {
                        msg = "The stock is out now, the restock time will be at 11am & 9pm daily. Please come back later.";
                        $('#alert').html('<p>'+msg+'</p>');
                        $('#ModalAlert').modal('show');
                    } else if(data.status == 1009 || data.status == 1010) {
                        $('#alert').html('<p>'+data.msg+'</p>');
                        $('#ModalAlert').modal('show');
                    }
                }
                $('#commodity_id').val(it);
                $('#zzd').on('shown.bs.modal',function () {
                    gmfh = data;
                    var timeout = setTimeout(function () {
                        $('#zzd').modal('hide');
                    },1200);
                });
            },
            error: function(){
                $('#alert').html('<p>Net Error!</p>');
                $('#ModalAlert').modal('show');
            }
        });
        $('#zzd').on('hide.bs.modal', function () {
            dde(gmname, gmfh);
        })
    }

    function buy(){
        var id = $('#id').val();
        var commodity_id = $('#commodity_id').val();
        var name = $('#itname').val();
        var recipient = $('#recipient').val();
        if(name == 'Mobile Legends'){
            var moblieLegend = $('#moblieLegend').val();
            var moblieLegendExtra = $('#moblieLegendExtra').val();
            if (moblieLegend == null || moblieLegend == '' || moblieLegendExtra == null || moblieLegendExtra == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
        }else{
            if (recipient == null || recipient == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
            var phone = $('#phone').val();
            if (phone == null || phone == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }

            var address = $('#address').val();
            if (address == null || address == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }

            var phoneType = $('#phoneType').val();
            if (phoneType == null || phoneType == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
        }
        $.ajax({
            url : baseUrl+"/shop/buy",
            type : 'post',
            dataType : 'json',
            data: {
                id: id,
                commodityId:commodity_id,
                recipient:recipient,
                phone: phone,
                moblieLegend: moblieLegend+"("+moblieLegendExtra+")",
                address: address,
                phoneType: phoneType
            },
            headers:
                {
                    authorization: token
                },
            success: function(data){
                var storeLink = 'https://mixfun.world/index.html';
                var userAgentInfo = navigator.userAgent;
                if (userAgentInfo.indexOf('iPhone') > 0) {
                    storeLink = 'https://itunes.apple.com/ph/app/id1450796214?mt=8';
                } else if (userAgentInfo.indexOf('Android') > 0) {
                    storeLink = 'https://play.app.goo.gl/?link=https://play.google.com/store/apps/details?id=com.mixit.fun';
                }
                $('#ModalExchange').modal('hide');
                $('#alert').html('<p>If you enjoy using MixFun, please leave a good review for us? Thank you for your support! </p>' +
                    '<a class="btn btn-info" href="'+storeLink+'" target="_blank">YES</a>' +
                    '<a class="btn " id="pj" style="padding: 20%"  href="'+storeLink+'" data-dismiss="modal" target="_blank">NO</a>');
                $('#ModalAlert').modal('show');
                let sopt = shopSpotDic[id];
                shopSpotDic[id] = Math.max(0, sopt-1);
            }
        });
    }


    function exModelShow(){
        $('#ModalExchange').modal('show');
    }

    $('#ModalExchange').on('hide.bs.modal',function(){
        $('#ModalAlert').modal('show');
        $('#alert').html('<p style="color: red;">Confirm to quit?  If you quitted, you won’t able to redeem the gift. </p><button class="btn btn-info" data-dismiss="modal" aria-label="Close" style="margin-left: 20%">Quit</button><button class="btn" onclick="exModelShow()" style="margin-left: 20%">Cancel</button>');
        $('#ModalExchange').modal('show');
    });

    function copy(id){
        var copyVal = $('#'+id).val();
        if(copyVal != ''){
            var clipboard = new ClipboardJS('.'+id, {
                text: function() {
                    return copyVal;
                }
            });
            $('#copy_label').text('Copied!');
            $('#tot').modal('show');
        }else{
            $('#copy_label').text('Please login');
            $('#tot').modal('show');
        }
    }

    $('#tot').on('shown.bs.modal', function (e) {
        setTimeout(function () {
            $('#tot').modal('hide');
        },500)
    })

    function setShadeCode(){
        var shadeCode = $('#shadeCode').val();
        $.ajax({
            url : baseUrl+"/user/setFriendShareCode",
            type : 'post',
            dataType : 'json',
            data: JSON.stringify({
                share_code:shadeCode
            }),
            contentType:'application/json',
            headers:
                {
                    authorization: token
                },
            success: function(data){
                if(data.status == 0){
                    $('#alert').html('<p>Congratulations!</p><p>Both of you and your friends are received the 50 coin.</p>');
                    $('#ModalAlert').modal('show');
                    $('.shade').css('display','none');
                }else{
                    $('#alert').html('<p>'+data.msg+'</p>');
                    $('#ModalAlert').modal('show');
                }

            }
        });
    }

    let topListPageSize = 5;
    function loadTopList(pageNum) {
        var topListDiv = '';
        var pageRecords = new Array();
        let pages = parseInt(topList.length/topListPageSize);
        var count = 0;
        if (pageNum <= pages) {
            count = topListPageSize;
        } else {
            count = topList.length%topListPageSize;
        }
        for (var i = 0; i < count; i++) {
            let listIndex = Math.max(0, pageNum - 1) * topListPageSize + i;
            pageRecords[i] = topList[listIndex];
        }
        pageRecords.forEach(function(item, index) {
            var coverImg = "img/Video_Thumbnail.png";
            if(item.thumbnailUrl != null && item.thumbnailUrl != '' && item.thumbnailUrl != ' '){
                coverImg = item.thumbnailUrl;
            }
            var avatar = '';
            var userHasAvatarList = item.userAvatarList.filter(function(element) {
                return (element != null && element != '' && element != ' ');
            });
            item.userAvatarList.forEach(function (item, index) {
                var img = "img/person.png";
                if (index < userHasAvatarList.length) {
                    img = userHasAvatarList[index];
                }
                if (index > 2) {
                    return false;
                }
                avatar+='<img src="'+img+'" style="width: 24px;height: 24px;border-radius: 12px;margin: -3px;"/>';
            });
            var indexDiv = '';
            var listIndex = index + Math.max(0, pageNum - 1) * topListPageSize;
            if ([0, 1, 2].includes(listIndex)) {
                var img = "img/toplist_"+listIndex+".png";
                indexDiv = '<img src="'+img+'" style="width: 40px;height: 18px; padding-left: 6px; padding-right: 6px; margin-top: 41px;"/>';
            } else {
                indexDiv = '<div style="font-size: 16px; width: 40px; margin-top: 41px;">'+(listIndex+1)+'.'+'</div>';
            }
            topListDiv+= '<div class="media" style="margin-bottom: 5%; padding-top: 5%; position: relative">'+
                        indexDiv +
                        '<div style="width: 100px; height: 100px;">' +
                        '<img class="align-self-start mr-sm-2" src="'+coverImg+'" style="width: 100%; height: 100%; object-fit: cover; border-radius: 5px;"/>' +
                        '</div>'+
                        '<div class="media-body" style="padding-left: 3%;">'+
                        '<div class="mt-0"><p style="width: 100%;margin: 0px;text-align: left;"><span style="width: 100%; padding-right: 5px; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 3; overflow: hidden">'+item.title+'</span></p></div>'+
                        '<div style="position: absolute; right: 3%; bottom: 2%">'+avatar+'<span style="margin-left: 8px; font-size: 13px; font-weight: bold; color: #dcb336">'+item.totalContribute+'MixCoin</span></div>'+
                        '</div>'+
                        '</div>';
        });
        $('.topListDiv').html(topListDiv);
    }
    
    function perTopList() {
        let tempTopListPage = toplistPage;
        let newPage = toplistPage-1;
        toplistPage = Math.max(1, newPage);
        if (tempTopListPage != toplistPage) {
            loadTopList(toplistPage);
        }
    }

    function nextTopList() {
        let tempTopListPage = toplistPage;
        let maxPage = parseInt(topList.length/topListPageSize);
        let newPage = toplistPage+1;
        toplistPage = Math.min(maxPage, newPage);
        if (tempTopListPage != toplistPage) {
            loadTopList(toplistPage);
        }
    }
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138276305-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-138276305-1', {
         'page_title' : 'MixFun',
         'page_path': '/luck'
    });
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-8296699377234768",
    enable_page_level_ads: true
  });
</script>
</html>