<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MixFun</title>
    <link rel="icon" href="img/logo.png" type="image/x-icon">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Please help me to win the iPhone!ðŸ“±Just click the link belowðŸ˜" />
    <meta property="og:description" content="Please help me to win the iPhone!ðŸ“±Just click the link belowðŸ˜" />
    <meta property="og:image" content="images/share-logo.png" />
    <link rel="icon" href="img/logo.png" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css"/>
    <link rel="stylesheet" type="text/css" href="css/bootstrap-grid.css"/>
    <link rel="stylesheet" type="text/css" href="css/bootstrap-reboot.css"/>
    <link rel="stylesheet" type="text/css" href="css/slide-unlock.css"/>
</head>

<script src="https://code.jquery.com/jquery-3.4.0.js"></script>
<script src="js/jquery.i18n.properties-min-1.0.9.js" type="text/javascript"></script>
<script src="js/bootstrap.js"></script>
<script src="js/bootstrap.bundle.js"></script>
<script src="js/clipboard.min.js"></script>
<script src="http://cdn.bootcss.com/blueimp-md5/1.1.0/js/md5.min.js"></script>
<script src="js/jquery.slideunlock.js" type="text/javascript"></script>
<script src="js/platform.js" type="text/javascript"></script>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.3"></script>
<style>
    .top{
        background-image: url("img/bg_new.png");
        background-repeat: no-repeat;
        background-size: 100%;
    }
    .tooltip-inner{
        background-color: #b3d7ff;
        color: #6974FF;
        max-width: 300px;
    }
    .bs-tooltip-top .arrow::before, .bs-tooltip-auto[x-placement^="top"] .arrow::before{
        border-top-color: #b3d7ff;
    }
    .tooltip{
        align-content: center;
        z-index: -1;
    }
    input{
        margin-top: 15px;
    }
    textarea{
        margin-top: 15px;
    }
    li:hover{
        background-color: white;
    }
    .nav-link.active {
        color: #007bff;
    }
    .shade {
        margin-top: 30px;
    }

    .shareBtnTitle {
        font-size: 11px;
        color: gray;
        margin-top: 5px;
    }

    .shareBtn {
        margin-top: 5%;
        padding: 16px;
        background-size: cover;
    }
</style>
<body onload="showSurprise()">
<div class="container" style="padding:0;background-color: #f7f7fb;" align="center">
    <div align="center">
        <img id="tx" style="width: 50px;height: 50px;border-radius: 25px;position: inherit;z-index: 9999;margin-top: 25px;">
        <p id="mc" style="margin-top: 10px"></p>
    </div>

    <div class="card" style="width: 95%;border-radius: 10px;box-shadow: 2px 2px 2px #EEEEEE;">
        <div class="card-body" style="padding: 10px;">
            <p><span id="inviteNum1" style="color: #9B9B9B;font-size: medium"></span><span id="num" style="color: #6974FF"></span><span id="inviteNum2" style="color: #9B9B9B;font-size: medium"></span></p>
            <div id="ref"></div>
            <p class="card-text">
                <span id="referralCode"></span>
                <input id="shareId" style="border: 0px;width: 100px;" readonly/>
                <button class="btn shareId" id="copy" data-clipboard-target="#shareId" data-clipboard-action="copy" style="background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;" onclick="copy('shareId')" ></button>
            </p>
            <div style="margin-top: 20px; margin-bottom: 10px;">
                <p id="shareReferal"></p>
                <row>
                    <a class="col-4 fc" style="padding: 10%"  href="" target="_blank">
                        <img  id="tips" src="img/icon_facebook.png" data-toggle="popover" data-placement="top" data-content="Share the referral link to your friend and both of you will win 50 coins.">
                    </a>
                    <a class="col-4 lj" style="padding: 10%" target="_blank" onclick="copy('lj')">
                        <input id="lj" type="hidden">
                        <img src="img/icon_ic_link.png">
                    </a>
                </row>
            </div>
        </div>
    </div>

    <div id="spinDiv" align="center" style="margin-top: 4%; display: none">
        <a id="spinURL" target="_blank">
            <img src="img/Lucky_Spin_banner.png" style="width: 98%">
        </a>
    </div>

    <div class="shade" align="center">
        <p id="shareReferal1"></p>
        <input class="form-control" id="shareCode" style="width: 70%;border-radius: 15px;">
        <button class="btn btn-light" style="margin-top: 10px; background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;" onclick="setShareCode()">Submit</button>
    </div>
    <div id="activityList" style="margin-top: 20px"></div>
</div>

<div id="redeemschedule" align="center" style="margin-top: 10px">
  <details>
    <summary>See the redeem schedule</summary>
    <div id="schedulelist" style="padding: 2%"></div>
  </details>
</div>

<div align="center" id="adsDiv" style="margin-top: 6%; display: none">
    <a target="_blank" id="androidlazadaURL">
        <img src="img/lazada_banner.png" style="width: 98%">
    </a>
</div>

<div id="footer" style="width: 100%;margin-top: 20px;" align="center">
    <p>Contact us on <a href="https://www.facebook.com/groups/419649578852831/"> Facebook</a></p>
    <p style="color: #BC9982;">Â© 2019 MIXFUN LIMITED</p>
</div>

<!-- alert -->
<div class="modal fade" id="ModalAlert" tabindex="-1" role="dialog" aria-labelledby="ModalNoticeTitleAlert" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document" style="border-radius: 20px;">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header" style="background: linear-gradient(to right, #b4d0ef, #e4f1f8);border-radius: 20px 20px 0 0;">
                <h5 class="modal-title" id="ModalNoticeTitleAlert"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="alert"></div>
        </div>
    </div>
</div>

<!-- alert -->
<div class="modal fade" id="ModalConf" tabindex="-1" role="dialog" aria-labelledby="ModalNoticeTitleConf" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document" style="border-radius: 20px;">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header" style="background: linear-gradient(to right, #b4d0ef, #e4f1f8);border-radius: 20px 20px 0 0;">
                <h5 class="modal-title" id="ModalNoticeTitleConf"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="type1"><span class="hf"></span><span id="type1Text"></span></p>
                <p id="type2"><span class="hf"></span><span id="type2Text"></span></p>
                <button class="btn btn-info" onclick="cjl()" style="margin-top: 20px" id="ModalConfContinue"></button>
                <button class="btn" data-dismiss="modal" aria-label="Close" style="margin-top: 20px" id="ModalConfCancel"></button>
                <input id="it" type="hidden"/>
                <input id="itname" type="hidden"/>
                <input id="ittype" type="hidden"/>
            </div>
        </div>
    </div>
</div>

<!-- Exchange -->
<div class="modal fade" id="ModalExchange" tabindex="-1" role="dialog" aria-labelledby="ModalNoticeTitleExchange" aria-hidden="true" style="margin-top: 8%;border-radius: 20px;">
    <div class="modal-dialog" role="document" style="border-radius: 20px;height: 100%">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header" style="background: linear-gradient(to right, #b4d0ef, #e4f1f8);border-radius: 20px 20px 0 0;">
                <h5 class="modal-title" id="ModalNoticeTitleExchange"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding-bottom: 5px;">
                    <span id="exchangeNotice"></span>
            </div>
            <span id="bt" style="color: red;margin-left: 10%;"></span>
            <div class="modal-body" align="center">
                <input type="hidden" id="id"/>
                <input type="hidden" id="commodity_id"/>
                <input class="form-control" type="text" id="recipient" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"/>
                <input class="form-control" id="phoneType" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;margin-top: 10px;">
                <input class="form-control" type="text" id="phone" maxlength="11" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"/>
                <input class="form-control" type="text" id="moblieLegend" maxlength="9" style="border-radius: 15px;background-color: #F1F1F1;border: 0px; width: 78%; display: inline-block;"/>
                <input class="form-control" type="text" id="moblieLegendExtra" placeholder="1234" maxlength="4" style="border-radius: 15px;background-color: #F1F1F1;border: 0px; width: 20%; display: inline-block;"/>
                <input class="form-control" type="text" id="rosInput" placeholder="Rules of Survival ID: 123456789" maxlength="9" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"/>
                <input class="form-control" type="text" id="gcashAccount" maxlength="11" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"/>
                <textarea class="form-control" id="address" style="border-radius: 15px;background-color: #F1F1F1;border: 0px;"></textarea>
                <p style="margin-top: 10px;" id="exchangeNotice1"></p>
                <button onclick="buy()" class="btn" style="background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;" id="exchangeSubmit"></button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ModalMiniworld" tabindex="-1" role="dialog" aria-labelledby="ModalNoticeTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document" style="border-radius: 20px;">
        <div class="modal-content" style="border-radius: 20px;">
            <div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="height: 40px; width: 60px">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" align="center" style="padding-top: 0">
                <p style="text-align: left">Here is your code, please copy and activate it in your Mini World account.</p>
                <p id="miniworldID" style="text-align: center; font-size: 18px; font-weight: 500"></p>
                <button class="btn copyBtn" id="miniworldIDBtn" style="background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;" onclick="copyAction('miniworld')">&nbsp;Copy&nbsp;</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ModalShare" tabindex="-1" role="dialog" aria-labelledby="ModalNoticeTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document" style="border-radius: 20px;">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-header" style="background: linear-gradient(to right, #b4d0ef, #e4f1f8);border-radius: 20px 20px 0 0;">
                <h5 class="modal-title" id="ModalNoticeTitle">Message</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p id="gcashNoticeID" style="margin-bottom: 20px;"></p>
                <p id="gcashNotice"></p>
                <div align="center">
                    <div>
                        <div style="display: inline-block; margin-top: 5%; margin-right: 20%">
                            <button class="btn shareBtn" id="shareFacebookBtn" style="background-image: url(img/icon_facebook.png);"></button>
                            <p class="shareBtnTitle">Facebook</p >
                        </div>
                        <div style="display: inline-block; margin-top: 5%">
                            <button class="btn shareBtn copyBtn" data-clipboard-action="copy" style="background-image: url(img/icon_ic_link.png);" onclick="copyAction('link')"></button>
                            <p class="shareBtnTitle">Link</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="ModalDownloadGCash" tabindex="-1" role="dialog" aria-labelledby="ModalNoticeTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document" style="border-radius: 20px;">
        <div class="modal-content" style="border-radius: 20px;">
            <div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="height: 40px; width: 60px">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" align="center" style="padding-top: 0">
                <dl style="text-align: left">
                    <dd style="margin-top: 10px" id="downloadGcashNotice"></dd>
                    <dd style="margin-top: 20px; margin-bottom: 20px"><a id="iOSGCash" target="_blank">iOS&nbsp;&nbsp;</a><a id="AndroidGCash" target="_blank">&nbsp;&nbsp;&nbsp;Android&nbsp;&nbsp;</a></dd>
                </dl>
            </div>
            <div align="right">
                <button class="btn" data-dismiss="modal" aria-label="Close" style="margin-bottom: 5%; margin-top: -10px; display: inline-block">Cancel</button>
                <button class="btn btn-info" onclick="exchangeGCash()" style="margin: -10px 20px 5%;display: inline-block">I've downloaded</button>
            </div>
        </div>
    </div>
</div>

<!-- tip -->
<div class="modal fade" id="tot" tabindex="-1" role="dialog" aria-labelledby="Box" aria-hidden="true" style="margin-top: 20%;">
    <div class="modal-dialog" role="document" style="border-radius: 20px;height: 100%">
        <div class="modal-content" style="border-radius: 20px;">
            <div class="modal-body">
                <h5 class="modal-title" id="copy_label"></h5>
            </div>
        </div>
    </div>
</div>

<!-- tip -->
<div class="modal fade" id="zzd" tabindex="-1" role="dialog" aria-labelledby="Box" aria-hidden="true" style="margin-top: 20%;" align="center">
    <div class="modal-dialog" role="document" style="border-radius: 20px;height: 100%">
        <div class="spinner-grow text-primary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-secondary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-success" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-danger" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-warning" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-info" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-light" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <div class="spinner-grow text-dark" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</div>
</body>

<script type="text/javascript">
    var baseUrl = "https://api.mixit.fun/";
 //   var baseUrl = "http://34.87.14.19:7001/";

    var clientHeight = document.body.clientHeight;
    var clientWidth = document.body.clientWidth;
    $('.top').css('height',170/(375/clientWidth)+"px");
    $('.d-block').css('height',clientHeight/4);
    $('#ModalExchange').css('height',clientHeight);
    $('#zzd').css('margin-top',clientHeight/2);
    $('#tips').tooltip('show');
    $('.toast').toast('show');
    let secretSign = "Wfy^%kdgfg)k!";
    $('.modal').on("hidden.bs.modal", function () {
        if($('.modal:visible').length)
        {
            $('.modal-backdrop').first().css('z-index', parseInt($('.modal:visible').last().css('z-index')) - 10);
            $('body').addClass('modal-open');
        }
    }).on("show.bs.modal", function (e) {
        if($('.modal:visible').length)
        {
            $('.modal-backdrop.in').first().css('z-index', parseInt($('.modal:visible').last().css('z-index')) + 10);
            $(this).css('z-index', parseInt($('.modal-backdrop.in').first().css('z-index')) + 10);
        }
    });

    var newVersion = "0";
    function GetRequest() {
        var url = location.search;
        var theRequest = new Object();
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            strs = str.split("&");
            for (var i = 0; i < strs.length; i++) {
                theRequest[strs[i].split("=")[0]] = unescape(strs[i].split("=")[1]);
            }
        }
        newVersion = theRequest.platform;
        let spinLink = document.getElementById('spinURL');
        spinLink.href = "https://mixfun.world/turnplate.html?id="+theRequest.id;
        return theRequest;
    }
    var token =  GetRequest().id;

    var regionCode = "ph";
    var addJSFunction = true;
    if (platform.os.toString().indexOf('Android') > -1) {
        try {
            regionCode = window.android.getRegionCode();
            JSBridgeComplete();
        } catch (e) {
            JSBridgeComplete();
        }
    } else if (platform.os.toString().indexOf('iOS') > -1) {
        function setupWebViewJavascriptBridge(callback) {
            if (window.WebViewJavascriptBridge) { return callback(WebViewJavascriptBridge); }
            if (window.WVJBCallbacks) { return window.WVJBCallbacks.push(callback); }
            window.WVJBCallbacks = [callback];
            var WVJBIframe = document.createElement('iframe');
            WVJBIframe.style.display = 'none';
            WVJBIframe.src = 'https://__bridge_loaded__';
            document.documentElement.appendChild(WVJBIframe);
            setTimeout(function() {
                document.documentElement.removeChild(WVJBIframe);
            }, 0)
        }

        setupWebViewJavascriptBridge(function(bridge) {
            addJSFunction = false;
            document.getElementById('shareFacebookBtn').onclick = function () {
                let productname = $('#productName').html();
                let shareTitle = "Tell your friend you have redeemed "+productname+"? Share the joy with them.";
                let facebookURL = "https://www.facebook.com/sharer.php?title="+shareTitle+"&u="+lj+"";
                bridge.callHandler('openURL', {'url': facebookURL}, function(response) {
                });
            };
            bridge.callHandler("getRegionCode", null, function(response) {
                regionCode = response;
                JSBridgeComplete();
            });

        })
    } else {
        JSBridgeComplete();
    }

    function JSBridgeComplete() {
        if (addJSFunction) {
            document.getElementById('shareFacebookBtn').onclick = function () {
                let productname = $('#productName').html();
                let shareTitle = "Tell your friend you have redeemed "+productname+"? Share the joy with them.";
                let facebookURL = "https://www.facebook.com/sharer.php?title="+shareTitle+"&u="+lj+"";
                try {
                    window.android.BackToAndroid(facebookURL);
                } catch (e) {
                    window.location.href = facebookURL;
                }
            };
        }
        translate();
    }

    var shareCodeSuccess;
    var blockMsg;
    var emptyStockMsg;
    var gcashBuyNotice;
    var gcashDisableNotice;
    var redeemStr;
    var lang = 'en';
    function translate() {
        $(function() {
            if (regionCode == "id") {
                lang = "id";
            }
            jQuery.i18n.properties({
                name: 'strings',
                path: 'i18n/',
                mode: 'map',
                language: lang,
                callback: function() {
                    $('#inviteNum1').html($.i18n.prop('inviteNum1'));
                    $('#inviteNum2').html($.i18n.prop('inviteNum2'));
                    $('#referralCode').html($.i18n.prop('referralCode'));
                    $('#copy').html($.i18n.prop('copy'));
                    $('#shareReferal').html($.i18n.prop('shareReferal'));
                    $('#shareReferal1').html($.i18n.prop('shareReferal1'));
                    $('#shareCode').attr('placeholder', $.i18n.prop('shareCodePlaceHolder'));
                    $('#type1Text').html($.i18n.prop('type1Text'));
                    $('#type2Text').html($.i18n.prop('type2Text'));
                    $('#ModalConfContinue').text($.i18n.prop('ModalConfContinue'));
                    $('#ModalConfCancel').text($.i18n.prop('ModalConfCancel'));
                    $('#ModalNoticeTitleAlert').text($.i18n.prop('ModalNoticeTitleAlert'));
                    $('#ModalNoticeTitleConf').text($.i18n.prop('ModalNoticeTitleConf'));
                    $('#ModalNoticeTitleExchange').text($.i18n.prop('ModalNoticeTitleExchange'));
                    $('#exchangeNotice').html($.i18n.prop('exchangeNotice'));
                    $('#exchangeNotice1').text($.i18n.prop('exchangeNotice1'));
                    $('#exchangeSubmit').text($.i18n.prop('exchangeSubmit'));
                    $('#phoneType').attr('placeholder', $.i18n.prop('phoneTypePlaceHolder'));
                    $('#recipient').attr('placeholder', $.i18n.prop('recipientPlaceHolder'));
                    $('#phone').attr('placeholder', $.i18n.prop('phonePlaceHolder'));
                    $('#moblieLegend').attr('placeholder', $.i18n.prop('moblieLegendPlaceHolder'));
                    $('#gcashAccount').attr('placeholder', $.i18n.prop('gcashAccountPlaceHolder'));
                    $('#address').attr('placeholder', $.i18n.prop('addressPlaceHolder'));
                    $('#gcashNotice').html($.i18n.prop('gcashNotice'));
                    $('#downloadGcashNotice').html($.i18n.prop('downloadGcashNotice'));
                    redeemStr = $.i18n.prop('redeemStr');
                    shareCodeSuccess = $.i18n.prop('shareCodeSuccess');
                    blockMsg = $.i18n.prop('blockMsg');
                    emptyStockMsg = $.i18n.prop('emptyStockMsg');
                    gcashBuyNotice = $.i18n.prop('gcashBuyNotice');
                    gcashDisableNotice = $.i18n.prop('gcashDisableNotice');
                }
            });
        })
    }

    function showSurprise() {
        if (newVersion == "1") {
            $('#activityList').hide();
            $('#adsDiv').hide();
            $('#spinDiv').hide();
        } else {
            $('#adsDiv').show();
            $('#spinDiv').show();
        }
    }

    $.ajax({
        method: 'get',
        url: baseUrl+'user/referralList',
        headers:{
            authorization:token
        },
        contentType:'application/json',
        dataType: 'json',
        success: function(data){
            $('#num').html(data.data.length);
            var ht = '';
            data.data.forEach(function (item,index) {
                var img = "img/person.png";
                if(item.avatar != null && item.avatar != '' && item.avatar != ' '){
                    img = item.avatar;
                }
                if (index > 9) {
                    return false;
                }
                ht+='<img src="'+img+'" style="width: 40px;height: 40px;border-radius: 20px;margin: 2px;"/>';
            });
            $('#ref').html(ht);
        }
    });

    var isBlockUser = false;
    var fc;
    var lj;
    var uid;
    var iosGCashURL;
    var androidGCashURL;
    $.ajax({
        method: 'get',
        url: baseUrl+'user/profile',
        headers:{
            authorization:token
        },
        contentType:'application/json',
        dataType: 'json',
        success: function(data){
            if (data.data.status < 0) {
                isBlockUser = true;
            }
            fc = "https://www.facebook.com/sharer/sharer.php?u=https://mixfun.world/friend?c="+data.data.ownShareCode+" &t=Please help me to win the iPhone!ðŸ“±Just click the link belowðŸ˜";
            lj = "https://mixfun.world/friend?c="+data.data.ownShareCode;
            if (data.data.avatar == null) {
                $('#tx').attr('src','img/logo_midium.png');
            } else {
                let avatarStr = data.data.avatar.trim()
                if (avatarStr == '') {
                    $('#tx').attr('src','img/logo_midium.png');
                } else {
                    $('#tx').attr('src',avatarStr);
                }
            }
            uid = data.data.uid;
            $('#mc').text(data.data.nickname);
            $('#shareId').val(data.data.ownShareCode);
            iosGCashURL = 'https://clk.omgt3.com/?PID=36035&AID=1980884&UID='+data.data.ownShareCode;
            androidGCashURL = 'https://clk.omgt3.com/?PID=36032&AID=1980884&UID='+data.data.ownShareCode;
            $('#iOSGCash').attr('href', 'https://clk.omgt3.com/?PID=36035&AID=1980884&UID='+data.data.ownShareCode);
            $('#AndroidGCash').attr('href', 'https://clk.omgt3.com/?PID=36032&AID=1980884&UID='+data.data.ownShareCode);
             $('#androidlazadaURL').attr('href', 'https://c.lazada.com.ph/t/c.bXJ5?UID='+data.data.ownShareCode);
            $('#copy').attr('data-clipboard-text',data.data.ownShareCode);
            if(data.data.shareCode != null){
                $('.shade').css('display','none');
            }
            $('#lj').val("https://mixfun.world/friend?c="+data.data.ownShareCode);
            $('.fc').attr('href',"https://www.facebook.com/sharer/sharer.php?u=https://mixfun.world/friend?c="+data.data.ownShareCode+" &t=Please help me to win the iPhone!ðŸ“±Just click the link belowðŸ˜");
            $('#wc').attr('href',"https://api.whatsapp.com/api/send?phone=+8618682018597&send?text=Please help me to win the iPhone!ðŸ“±Just click the link belowðŸ˜  https://mixfun.world/friend?c="+data.data.ownShareCode);
            createRedeemList();
        }
    });
    function setShareCode(){
        var shareCode = $('#shareCode').val();
        $.ajax({
            url : baseUrl+"/user/setFriendShareCode",
            type : 'post',
            dataType : 'json',
            data: JSON.stringify({
                share_code:shareCode
            }),
            contentType:'application/json',
            headers:
                {
                    authorization: token
                },
            success: function(data){
                if(data.status == 0){
                    $('#alert').html(shareCodeSuccess);
                    $('#ModalAlert').modal('show');
                    $('.shade').css('display','none');
                }else{
                    $('#alert').html('<p>'+data.msg+'</p>');
                    $('#ModalAlert').modal('show');
                }
            }
        });
    }
    function cj(it,name,sale,type,commodity_id) {
        if (shopSpotDic[it] > 0) {
            if (isBlockUser) {
                var msg = blockMsg;
                $('#alert').html('<p>'+msg+'</p>');
                $('#ModalAlert').modal('show');
            } else {
                if (name == 'GCash') {
                    $('#ModalDownloadGCash').modal('show');
                } else {
                    $('#ModalConf').modal('show');
                }
                $('#it').val(it);
                $('#itname').val(name);
                $('#ittype').val(type);
                $('#commodity_id').val(commodity_id);
                if(type == 1){
                    $('#type2').css('display','none');
                    $('#type1').css('display','block');
                }else{
                    $('#type1').css('display','none');
                    $('#type2').css('display','block');
                }
                $('.hf').text(sale);
            }
        } else {
            let msg = emptyStockMsg;
            $('#alert').html('<p>'+msg+'</p>');
            $('#ModalAlert').modal('show');
        }
    }
    function exchangeGCash() {
        $('#ModalDownloadGCash').modal('hide');
        $('#ModalDownloadGCash').on('hidden.bs.modal', function () {
            $('#ModalDownloadGCash').off('hidden.bs.modal');
            $('#ModalConf').modal('show');
        });
    }
    function dde(name, data) {
        if(name == 'Mini Beans') {
            let it = $('#it').val();
            let sopt = shopSpotDic[it];
            let subSopt = Math.max(0, sopt-1);
            shopSpotDic[id] = subSopt;
            $('#shop'+it).html('Spot: '+subSopt);
            $('#miniworldID').text(data.data.recipient);
            $('#ModalMiniworld').modal('show');
        } else {
            $('#address').val('');
            $('#phone').val('');
            $('#phoneType').val('');
            $('#moblieLegend').val('');
            $('#moblieLegendExtra').val('');
            $('#rosInput').val('');
            $('#gcashAccount').val('');
            if(name == 'Mobile Legends') {
                $('#gcashAccount').css('display', 'none');
                $('#rosInput').css('display', 'none');
                $('#address').css('display','none');
                $('#phone').css('display','none');
                $('#phoneType').css('display','none');
                $('#moblieLegend').css('display','inline-block');
                $('#moblieLegendExtra').css('display','inline-block')
            } else if(name == 'Rules of Survival') {
                $('#gcashAccount').css('display', 'none');
                $('#address').css('display','none');
                $('#phone').css('display','none');
                $('#phoneType').css('display','none');
                $('#moblieLegend').css('display','none');
                $('#moblieLegendExtra').css('display','none');
                $('#rosInput').css('display', 'block');
            } else if (name == 'GCash') {
                $('#address').css('display','none');
                $('#phone').css('display','none');
                $('#phoneType').css('display','none');
                $('#moblieLegend').css('display','none');
                $('#moblieLegendExtra').css('display','none');
                $('#rosInput').css('display', 'none');
                $('#gcashAccount').css('display', 'block');
            } else {
                $('#gcashAccount').css('display', 'none');
                $('#rosInput').css('display', 'none');
                $('#address').css('display','block');
                $('#phone').css('display','block');
                $('#phoneType').css('display','block');
                $('#moblieLegend').css('display','none');
                $('#moblieLegendExtra').css('display', 'none');
            }
            $('#ModalExchange').modal('show');
            $('#id').val(data.data.id);
        }
    }
    var ss;
    var gmfh;
    var hasVerify = true;
    function cjl(){
        if (hasVerify) {
            var it = $('#it').val();
            var gmname = $('#itname').val();
            var type = $('#ittype').val();
            var time = new Date().getTime();
            var key = md5(uid+secretSign+time);
            var url = baseUrl+'shop/exchange';
            if (gmname == 'Mini Beans') {
                url = baseUrl+'shop/exchangeGameCode';
            }
            $('#ModalConf').modal('hide');
            $.ajax({
                method: 'post',
                url: url,
                headers:{
                    authorization:token
                },
                data: {
                    commodityId: it,
                    type: type,
                    requestTime: time,
                    sign: key
                },
                dataType: 'json',
                success: function(data) {
                    if (data.status == 0) {
                        $('#zzd').modal('show');
                    } else {
                        let msg = data.msg;
                        if (msg == "The stock for this hour is out. Please come back next hour.") {
                            msg = emptyStockMsg;
                            $('#alert').html('<p>'+msg+'</p>');
                            $('#ModalAlert').modal('show');
                        } else {
                            $('#alert').html('<p>'+msg+'</p>');
                            $('#ModalAlert').modal('show');
                        }
                    }
                    $('#commodity_id').val(it);
                    $('#zzd').on('shown.bs.modal',function () {
                        gmfh = data;
                        var timeout = setTimeout(function () {
                            $('#zzd').modal('hide');
                        },1200);
                    });
                },
                error: function(){
                    $('#alert').html('<p>Net Error!</p>');
                    $('#ModalAlert').modal('show');
                }
            });
            $('#zzd').on('hide.bs.modal', function () {
                dde(gmname, gmfh);
            })
        } else {
            $('#copy_label').text('Please verify first');
            $('#tot').modal('show');
        }
    }
    function buy(){
        var id = $('#id').val();
        var commodity_id = $('#commodity_id').val();
        var name = $('#itname').val();
        var recipient = $('#recipient').val();
        var playerID;
        if(name == 'Mobile Legends') {
            var moblieLegend = $('#moblieLegend').val();
            var moblieLegendExtra = $('#moblieLegendExtra').val();
            if (moblieLegend == null || moblieLegend == '' || moblieLegendExtra == null || moblieLegendExtra == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
            playerID = moblieLegend+"("+moblieLegendExtra+")";
        } else if(name == 'Rules of Survival') {
            var rosID = $('#rosInput').val();
            if (rosID == null || rosID == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
            playerID = rosID;
        } else  if(name == 'GCash') {
            var gcashID = $('#gcashAccount').val();
            if (gcashID == null || gcashID == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
            playerID = gcashID;
        } else{
            if (recipient == null || recipient == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
            var phone = $('#phone').val();
            if (phone == null || phone == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
            var address = $('#address').val();
            if (address == null || address == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
            var phoneType = $('#phoneType').val();
            if (phoneType == null || phoneType == ''){
                $('#bt').text('Please fill up all your details.');
                return;
            }
        }
        $.ajax({
            url : baseUrl+"shop/buy",
            type : 'post',
            dataType : 'json',
            data: {
                id: id,
                commodityId:commodity_id,
                recipient:recipient,
                phone: phone,
                moblieLegend: playerID,
                address: address,
                phoneType: phoneType
            },
            headers:
                {
                    authorization: token
                },
            success: function(data){
                var storeLink = 'https://mixfun.world/index.html';
                var userAgentInfo = navigator.userAgent;
                if (userAgentInfo.indexOf('iPhone') > 0) {
                    storeLink = 'https://itunes.apple.com/ph/app/id1450796214?mt=8';
                } else if (userAgentInfo.indexOf('Android') > 0) {
                    storeLink = 'https://play.app.goo.gl/?link=https://play.google.com/store/apps/details?id=com.mixit.fun';
                }
                $('#ModalExchange').modal('hide');
                if(name == 'GCash') {
                    $('#gcashNoticeID').html(gcashBuyNotice);
                    $('gcashNoticeID').css('display', 'block');
                } else {
                    $('gcashNoticeID').css('display', 'none');
                }
                $('#productName').html(name);
                $('#ModalShare').modal('show');
                let sopt = shopSpotDic[commodity_id];
                let subSopt = Math.max(0, sopt-1);
                shopSpotDic[commodity_id] = subSopt;
                $('#shop'+commodity_id).html('Spot: '+subSopt);
            }
        });
    }
    function exModelShow(){
        var buttonTap = true;
        $('#ModalAlert').modal('hide');
        $('#ModalAlert').on('hidden.bs.modal', function () {
            $('#ModalAlert').off('hidden.bs.modal');
            if (!buttonTap) {
                return;
            }
            buttonTap = false;
            $('#ModalExchange').modal('show');
        });
    }
    $('#ModalExchange').on('hide.bs.modal',function(){
        $('#ModalAlert').modal('show');
        $('#alert').html('<p style="color: red;">Confirm to quit? If you quitted, you wonâ€™t able to redeem the gift. </p><button class="btn btn-info" data-dismiss="modal" aria-label="Close" style="margin-left: 20%">Quit</button><button class="btn" onclick="exModelShow()" style="margin-left: 20%">Cancel</button>');
    });
    function copy(id){
        var copyVal = $('#'+id).val();
        if(copyVal != ''){
            var clipboard = new ClipboardJS('.'+id, {
                text: function() {
                    return copyVal;
                }
            });
            clipboard.on('successfully', function(e){
                clip.destroy();
            });
            $('#copy_label').text('Copied!');
            $('#tot').modal('show');
        }else{
            $('#copy_label').text('Please login');
            $('#tot').modal('show');
        }
    }

    function copyAction(type) {
        $('#copy_label').text('Copied!');
        $('#tot').modal('show');
        if (type == "miniworld") {
            let clip = new ClipboardJS('.copyBtn', {
                container: document.getElementById('ModalMiniworld'),
                text: function(trigger) {
                    var str = $('#miniworldID').text();
                    return str;
                }
            });
            clip.on('successfully', function(e){
                clip.destroy();
            });
        } else if (type == "link") {
            let clip = new ClipboardJS('.copyBtn', {
                container: document.getElementById('ModalShare'),
                text: function(trigger) {
                    let productname = $('#productName').html();
                    let str = "Tell your friend you have redeemed "+productname+"? Share the joy with them.</br>"+lj;
                    return str;
                }
            });
            clip.on('successfully', function(e){
                clip.destroy();
            });
        }
    }

    $('#tot').on('shown.bs.modal', function (e) {
        setTimeout(function () {
            $('#tot').modal('hide');
        },500)
    })
    $(function () {
        let slider = new SliderUnlock("#slider", {}, function () {
            hasVerify = true;
        });
        slider.init();
    })

    function createRedeemList() {
        $.ajax({
            method: 'post',
            url: baseUrl + 'shop/list/all',
            headers: {
                authorization: token
            },
            data: {
                regionCode: regionCode
            },
            dataType: 'json',
            success: function (data) {
                if (data.status == 0) {
                    var liStr = '<ul class="nav nav-tabs nav-justified">';
                    var tabStr = '<div id="myTabContent" class="tab-content">';
                    data.data.forEach(function(item, index) {
                        let code = item.type;
                        let name = item.name;
                        $('#shopList_' + code).html('');
                        if (index == 0) {
                            liStr += '<li class="nav-item" style="font-size: 13px">';
                            liStr += '<a class="nav-link active" href="#shopList_'+code+'" data-toggle="tab">'+name+'</a>';
                            liStr += '</li>';

                            tabStr += '<div class="tab-pane active" id="shopList_'+code+'">';
                            tabStr += '</div>';
                        } else {
                            liStr += '<li class="nav-item" style="font-size: 13px">';
                            liStr += '<a class="nav-link" href="#shopList_'+code+'" data-toggle="tab">'+name+'</a>';
                            liStr += '</li>';

                            tabStr += '<div class="tab-pane fade" id="shopList_'+code+'">';
                            tabStr += '</div>';
                        }
                    });
                    liStr += '</ul>';
                    tabStr += '</div>';
                    $('#activityList').html(liStr + tabStr);
                    data.data.forEach(function(item, index) {
                        let code = item.type;
                        let list = item.itemList;
                        GetRedeemList(code, list);
                    });
                }
            }
        });
    }


    $.ajax({
        method: 'get',
        url: baseUrl + 'shop/redeem/schedule',
        headers: {
          authorization: token
        },
        contentType:'application/json',
        dataType: 'json',
        success: function(data) {
          if (data.status == 0 && data.data.length > 0) {
            var htStr = '<table style="width: 100%; text-align: center; line-height: 26px; margin-bottom: 15px">';
            htStr += '<th style="width: 50%; font-size: 15px; font-weight: 400; color: #B1B5B9; padding-top: 0px">Project</th>';
            htStr += '<th style="width: 50%; font-size: 15px; font-weight: 400; color: #B1B5B9; padding-top: 0px">Date</th>';
            data.data.forEach(function(user, dindex) {
              let indexStr = dindex + 1;
              let name = user.name;
              let date = user.date;
              htStr += '<tr>';
              htStr += '<td style="font-size: 14px">' + name + '</td>';
              htStr += '<td style="font-size: 14px">' + date + '</td>';
              htStr += '</tr>';
            });
            htStr += '</table>';
            htStr += '<p style="text-align: center; margin-top: 10px;>This is the current redeem schedule of MixFun.</br>Please be patient and enjoy the video!</p>';
            $('#schedulelist').html(htStr);
          } else {
            let htStr = '<div><p style="text-align: center; margin-top: 10px;">Announce Soon</p></div>';
            $('#schedulelist').html(htStr);
          }
        },
        error: function() {
          let htStr = '<div><p style="text-align: center; margin-top: 10px;">Announce Soon</p></div>';
          $('#schedulelist').html(htStr);
        }
    });

    var shopSpotDic = new Array();
    function GetRedeemList(code, list) {
        let redeemType = 2;
        var ht;
        var imageURL = '';
        if (code == '5') {
            ht = '<p style="color: #ff000080;margin-top: 5px;width: 95%; text-align: left" class="alert alert-primary">'+gcashDisableNotice+'<br>Download now:<a target="_blank" href='+iosGCashURL+'>&nbsp;&nbsp;iOS&nbsp;&nbsp;</a><a target="_blank" href='+androidGCashURL+'>&nbsp;&nbsp;&nbsp;Android&nbsp;&nbsp;</a></p>';
        } else {
            ht = '<p style="color: #ff000080;margin-top: 5px;width: 95%" class="alert alert-primary">Items will be restocked by every 1000 new users.</p>';
        }
        if (list.length > 0) {
            for (var index in list) {
                let item = list[index];
                imageURL = 'img/shopList_img_'+code+'.png';
                var spot = item.glh;
                if (isBlockUser) {
                    spot = 0;
                }
                shopSpotDic[item.id] = spot;
                ht+= '<div class="media"style="padding: 3%">'+
                    '<div style="width: 25%;">' +
                    '<img src="'+imageURL+'" class="align-self-start mr-sm-2" style="width: 100%;border-radius: 5px;"/>' +
                    '<div style="width: 100%;height: 20px;background-color: #1b1e21;color: white;opacity: 0.6;margin-top: -20px;">'+item.sale+' coin</div>'+
                    '</div>'+
                    '<div class="media-body" style="padding-left: 3%;">'+
                    '<div class="mt-0"><p style="width: 100%;margin: 0px;text-align: left;"><span style="width: 80%;">'+item.name+'</span><span style="color: #9B9B9B;float: right;font-size: small;">Daily Totalï¼š'+item.amount+'</span></p></div>'+
                    '<p style="margin-top: 2px;margin-bottom: 5px;text-align: left;">'+item.description+'</p>'+
                    '<div class="mt-0">' +
                    '<p style="width: 100%;text-align: left;"><span id="shop'+item.id+'">Spot: '+spot+'</span>' +
                    '<button class="btn-sm" style="float: right;background: linear-gradient(to right, #F45D82, #6C81F8);border-radius: 20px;border: 0px;color: white;" onclick="cj('+item.id+',\''+item.name+'\','+item.sale+','+redeemType+')">'+redeemStr+'</button></p></div>'+
                    '</div>'+
                    '</div>';
            }
        } else {
            ht = '<p style="color: #ff000080;margin-top: 5px;width: 95%" class="alert alert-primary">We don\'t support the redemption in your country at the moment. We will open to your country when we reach 1,000 users. Please invite your friends to join MixFun.</p>';
        }
        $('#shopList_'+code).html(ht);
    }

</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138276305-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-138276305-1', {
        'page_title' : 'MixFun',
        'page_path': '/shop'
    });
</script>
</html>
